(function(){"use strict";var e={28:function(e,t,r){var o=r(144),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["welcome"==e.gameState?r("WelcomeScreen"):e._e(),"welcome"!=e.gameState?r("Game",{style:{opacity:e.activeGameState()}}):e._e(),"game_over"==e.gameState?r("GameOver"):e._e()],1)},s=[],n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"game"},[r("div",{staticClass:"glass"},e._l(e.glass,(function(t){return r("div",{staticClass:"line"},e._l(t,(function(t){return r("span",{staticClass:"block",style:{"background-color":e.activeColor(t)}})})),0)})),0),r("div",{staticClass:"widget"},[r("b",[e._v("NEXT FIGURE")]),e._l(e.widgetMatrix,(function(t){return r("div",{staticClass:"w-line"},e._l(t,(function(t){return r("span",{staticClass:"w-block",style:{"background-color":e.activeColor(t)}})})),0)})),r("b",[e._v("Your Score: "+e._s(100*e.score))]),e._v(" "),r("br"),r("b",[e._v("speed: "+e._s(1+Math.floor(e.score/10)))]),r("br"),r("br"),r("br"),r("b",[e._v("Controls: arrows")]),r("b")],2)])},a=[],u=r(738),l=r.p+"media/sounds.15aae32a.mp3";const g=9,c=0,d=20;var h=!0,m={data(){return{vlm:.3}},computed:{gameState(){return this.$store.getters.getStateOfGame},gravitySpeed(){return this.$store.getters.getGravitySpeed},glass(){return this.$store.getters.getGlass},figuresNames(){return this.$store.getters.getFiguresNames},nextFigureCoords(){return this.$store.getters.getNextFigureCoords},currentFigureCoords(){return this.$store.getters.getCurrentFigureCoords},nextFigureColor(){return this.$store.getters.getNextFigureColor},currentFigureColor(){return this.$store.getters.getCurrentFigureColor},isGameOver(){return this.$store.getters.getGOstatus},widgetMatrix(){return this.$store.getters.getWidgetMatrix},score(){return this.$store.getters.getScoreCounter},colorSheme(){return this.$store.getters.getColorScheme}},setup(){const[e]=(0,u.Z)(l,{sprite:{move:[2220,500],rotate:[2890,150],drop:[1290,250],destroy:[0,700],gameover:[8100,1100]},volume:.3});return{play:e}},watch:{score(){this.play({id:"destroy"})}},created(){this.init()},mounted(){document.addEventListener("keydown",(e=>this.keyboardDown(e))),document.addEventListener("keyup",(e=>this.keyboardUp(e)))},methods:{init(){this.$store.dispatch("cleanGlass"),this.prepareNextFigure(),this.putNextFigureInTheGlass(),window.setTimeout((()=>{this.loop()}),this.gravitySpeed)},loop(){if(1===this.isGameOver)return this.$store.dispatch("toggleGameState","game_over"),void this.play({id:"gameover"});!0===this.canCurrentFigureMoveDown()?this.moveFigureDown():(this.$store.dispatch("seekAndDestroyFullLine"),this.$store.dispatch("difficultyChanger"),this.putNextFigureInTheGlass()),window.setTimeout((()=>{this.loop()}),this.gravitySpeed)},keyboardDown(e){1!=this.isGameOver&&("ArrowLeft"===e.key&&this.moveFigureLeft(),"ArrowRight"===e.key&&this.moveFigureRight(),"ArrowDown"===e.key&&!0===h&&(this.softDrop("drop"),this.play({id:"move"}),h=!1),"ArrowUp"===e.key&&!0===h&&(this.figureRoration(),this.play({id:"rotate"}),h=!1),"Escape"===e.key&&window.location.reload())},keyboardUp(e){1!=this.isGameOver&&("ArrowUp"===e.key&&(h=!0),"ArrowDown"===e.key&&(this.softDrop("stop"),h=!0))},activeGameState(){return"game_over"===this.gameState?"0.4":"1"},activeColor(e){return e?"cf"===this.colorSheme?e:"black":"white"},prepareNextFigure(){let e=this.prepareNextFigureName(),t=[...JSON.parse(JSON.stringify(this.getFigureStartCoords(e)))],r=this.getFigureStartColor(e);this.$store.dispatch("addNextFigureCoordinatesToState",{coords:t,color:r})},prepareNextFigureName(){let e=Math.floor(Math.random()*this.figuresNames.length);return this.figuresNames[e]},getFigureStartCoords(e){return this.$store.getters.getFigureStartCoords(e)},getFigureStartColor(e){return this.$store.getters.getFigureStartColor(e)},putNextFigureInTheGlass(){if(!1===this.isNextFigureCollideGlass()){let e=[...JSON.parse(JSON.stringify(this.nextFigureCoords))],t=this.nextFigureColor;this.$store.dispatch("addCurrentFigureCoordinatesToState",{coords:e,color:t}),this.$store.dispatch("addCurrentFigureCoordsToGlass"),this.prepareNextFigure()}else this.$store.dispatch("setGOstatus",1)},isNextFigureCollideGlass(){let e=[...JSON.parse(JSON.stringify(this.nextFigureCoords))];for(let t=0;t<4;t++){let r=e[t][1],o=e[t][0];if(this.glass[o][r]>0||"string"===typeof this.glass[o][r])return this.play({id:"drop"}),!0}return!1},canCurrentFigureMoveDown(){let e=[...JSON.parse(JSON.stringify(this.currentFigureCoords))];if(e[3][0]<d){for(let t=0;t<4;t++){let r=e[t][1],o=e[t][0];if(this.glass[o+1][r]>0||"string"===typeof this.glass[o+1][r]){let t=e.filter((e=>e[0]===o+1&&e[1]===r));if(0===t.length)return this.play({id:"drop"}),!1}}return!0}return this.play({id:"drop"}),!1},isCurrentFigureBumpTheWall(e){let t;t="left"===e?c:g;let r=[...JSON.parse(JSON.stringify(this.currentFigureCoords))],o=r.filter((e=>e[1]===t));if(o.length>0)return!0},isHorizontalMovementPossible(e){let t;t="left"===e?-1:1;let r=[...JSON.parse(JSON.stringify(this.currentFigureCoords))];for(let o=0;o<4;o++){let e=r[o][1],i=r[o][0];if(this.glass[i][e+t]>0||"string"===typeof this.glass[i][e+t]){let o=r.filter((r=>r[0]===i&&r[1]===e+t));if(0===o.length)return this.play({id:"drop"}),!1}}return!0},moveFigureDown(){this.$store.dispatch("moveFigureDown")},moveFigureLeft(){return!0===this.isCurrentFigureBumpTheWall("left")?void 0:void(!0===this.isHorizontalMovementPossible("left")&&(this.$store.dispatch("moveFigureHorizontally","left"),this.play({id:"move"})))},moveFigureRight(){return!0===this.isCurrentFigureBumpTheWall("right")?void 0:void(!0===this.isHorizontalMovementPossible("right")&&(this.$store.dispatch("moveFigureHorizontally","right"),this.play({id:"move"})))},figureRoration(){this.$store.dispatch("figureRoration")},softDrop(e){this.$store.dispatch("softDrop",e)}}},f=m,p=r(1),C=(0,p.Z)(f,n,a,!1,null,null,null),v=C.exports,F=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"welcome"},[r("h1",{on:{click:e.start}},[e._v("TETRIS")]),r("h2",[e._v("Chose color scheme or press Any Key to start the game")]),r("div",{staticClass:"controls"},[r("button",{on:{click:function(t){return e.toggleColorScheme("cf")}}},[e._v("COLORFULL")]),r("button",{on:{click:function(t){return e.toggleColorScheme("bw")}}},[e._v("BLACK&WHITE")])]),e._m(0)])},y=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"contacts"},[r("a",{attrs:{href:"https://github.com/kay4yk13/tetris-vue",target:"_blank"}},[e._v("GitHub")])])}],S={created(){document.addEventListener("keydown",(e=>this.start()))},methods:{start(){this.$store.dispatch("toggleGameState","game"),this.$store.dispatch("setGOstatus",0)},toggleColorScheme(e){this.$store.dispatch("toggleColorScheme",e),this.start()}}},x=S,G=(0,p.Z)(x,F,y,!1,null,null,null),b=G.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"gameover",on:{click:this.goIndex}},[r("h1",[e._v("GAME OVER")]),r("h2",[e._v("press Any Key to return on main screen")])])},O=[],T={created(){document.addEventListener("keydown",(e=>this.goIndex()))},methods:{goIndex(){location.reload()}}},N=T,k=(0,p.Z)(N,w,O,!1,null,null,null),_=k.exports,$={components:{Game:v,WelcomeScreen:b,GameOver:_},computed:{gameState(){return this.$store.getters.getStateOfGame}},methods:{activeGameState(){return"game_over"===this.gameState?"0.5":"1"}}},M=$,E=(0,p.Z)(M,i,s,!1,null,null,null),I=E.exports,D=r(345);o.Z.use(D.Z);const A=[],L=new D.Z({mode:"history",base:"/tetris-vue/",routes:A});var Z=L,W=r(629);o.Z.use(W.ZP);var J=new W.ZP.Store({state:{figures:[{name:"O",coords:[[0,4],[0,5],[1,4],[1,5]],color:"blue"},{name:"T",coords:[[0,4],[0,5],[0,6],[1,5]],color:"orange"},{name:"S",coords:[[0,5],[0,6],[1,4],[1,5]],color:"yellow"},{name:"Z",coords:[[0,4],[0,5],[1,5],[1,6]],color:"green"},{name:"J",coords:[[0,4],[1,4],[1,5],[1,6]],color:"magenta"},{name:"L",coords:[[0,6],[1,4],[1,5],[1,6]],color:"grey"},{name:"I",coords:[[0,3],[0,4],[0,5],[0,6]],color:"red"}],glass:[],sandBoxGlass:[],currentFigureCoords:[],nextFigureCoords:[],currentFigureColor:0,nextFigureColor:0,nextFigureWIdgetMatrix:[],gameState:"welcome",isGameOver:0,scoreCounter:0,gravitySpeed:600,previousGravitySpeed:0,delay:[500,400,350,300,250,200,150,100,50,30],colorScheme:"cf"},getters:{getStateOfGame(e){return e.gameState},getGOstatus(e){return e.isGameOver},getColorScheme(e){return e.colorScheme},getGlass(e){return[...e.glass]},getFigureStartCoords:e=>t=>[...e.figures.find((e=>e.name===t)).coords],getFigureStartColor:e=>t=>e.figures.find((e=>e.name===t)).color,getFigures(e){return[...e.figures]},getFiguresNames(e){return[...e.figures.map((({name:e})=>e))]},getNextFigureCoords(e){return[...e.nextFigureCoords]},getCurrentFigureCoords(e){return[...e.currentFigureCoords]},getNextFigureColor(e){return e.nextFigureColor},getCurrentFigureColor(e){return e.currentFigureColor},getWidgetMatrix(e){return[...e.nextFigureWIdgetMatrix]},getGravitySpeed(e){return e.gravitySpeed},getScoreCounter(e){return e.scoreCounter}},actions:{toggleGameState({commit:e},t){e("toggleGameState",t)},toggleColorScheme({commit:e},t){e("toggleColorScheme",t)},cleanGlass({commit:e}){e("cleanGlass")},setGOstatus({commit:e},t){e("setGOstatus",t)},addNextFigureCoordinatesToState({commit:e},{coords:t,color:r}){e("addNextFigureCoordinatesToState",t),e("addNextFigureColorToState",r),e("matrixForWidget",0),e("matrixForWidget",r)},addCurrentFigureCoordinatesToState({commit:e},{coords:t,color:r}){e("addCurrentFigureCoordinatesToState",t),e("addCurrentFigureColorToState",r)},addCurrentFigureCoordsToGlass({commit:e}){let t=this.getters.getCurrentFigureColor;e("changeCurrentFigureCoordsInGlassTo",t)},moveFigureDown({commit:e}){let t=[...this.getters.getCurrentFigureCoords],r=this.getters.getCurrentFigureColor;e("changeCurrentFigureCoordsInGlassTo",0);for(let o=0;o<4;o++)t[o][0]++,e("addCurrentFigureCoordinatesToState",t);e("changeCurrentFigureCoordsInGlassTo",r)},moveFigureHorizontally({commit:e},t){let r=[...this.getters.getCurrentFigureCoords],o=this.getters.getCurrentFigureColor;e("changeCurrentFigureCoordsInGlassTo",0);for(let i=0;i<4;i++)"left"===t?r[i][1]--:r[i][1]++;e("addCurrentFigureCoordinatesToState",r),e("changeCurrentFigureCoordsInGlassTo",o)},softDrop({commit:e},t){e("softDrop",t)},difficultyChanger({commit:e}){let t,r=this.getters.getScoreCounter;t=r%10===0?r/10:Math.floor(r/10);let o=this.state.delay[t];e("difficultyChanger",o)},seekAndDestroyFullLine({commit:e}){let t=[...this.getters.getGlass];t.forEach(((t,r)=>{t.every((e=>e>0||"string"===typeof e))&&e("lineDestroyer",r)}))},figureRoration({commit:e}){let t,r=[...this.getters.getCurrentFigureCoords],o=[],i=[],s=[];for(let m=0;m<4;m++){let e=r[m][1],t=r[m][0];o.push(e),i.push(t)}for(let m=0;m<4;m++){let e=r[m][1]-Math.min(...o),t=r[m][0]-Math.min(...i);s.push([t,e])}let n=!1;Math.max(...o)-Math.min(...o)>Math.max(...i)-Math.min(...i)?(t=Math.max(...o)-Math.min(...o)+1,n=!1):(t=Math.max(...i)-Math.min(...i)+1,n=!0);let a=[];for(let m=0;m<t;m++)a.push(Array(t).fill(0));for(let m=0;m<4;m++){let e=s[m][1],t=s[m][0];a[t].splice(e,1,1)}let u=a[0].map(((e,t)=>a.map((e=>e[t])).reverse())),l=[];for(let m=0;m<u.length;m++){let e=[];u[m].forEach(((t,r,o)=>(1===t&&e.push(r),e)));for(let t=0;t<e.length;t++)l.push([m,e[t]])}let g,c=[];for(let m=0;m<4;m++){let e=l[m][0]+Math.min(...i);g=4===t?!0===n?l[m][1]+Math.min(...o)-1:l[m][1]+Math.min(...o)-2:!0===n&&3===t?l[m][1]+Math.min(...o)-1:l[m][1]+Math.min(...o),c.push([e,g])}for(let m=0;m<4;m++){let e=c.filter((e=>e[1]<0||e[1]>9));if(e.length>0)return}e("changeCurrentFigureCoordsInGlassTo",0);let d=[...this.getters.getGlass],h=this.getters.getCurrentFigureColor;for(let m=0;m<4;m++){let t=c[m][1],r=c[m][0];if(1===d[r][t])return void e("changeCurrentFigureCoordsInGlassTo",h)}e("updateCurrenFigureOrientation",{newCoords:c,size:t}),e("changeCurrentFigureCoordsInGlassTo",h)}},mutations:{difficultyChanger(e,t){e.gravitySpeed=t},softDrop(e,t){"drop"===t?(e.previousGravitySpeed=this.getters.getGravitySpeed,e.gravitySpeed=25):e.gravitySpeed=e.previousGravitySpeed},toggleGameState(e,t){e.gameState=t},toggleColorScheme(e,t){e.colorScheme=t},setGOstatus(e,t){e.isGameOver=t},addNextFigureCoordinatesToState(e,t){e.nextFigureCoords=t},addNextFigureColorToState(e,t){e.nextFigureColor=t},addCurrentFigureCoordinatesToState(e,t){e.currentFigureCoords=t},addCurrentFigureColorToState(e,t){e.currentFigureColor=t},updateCurrenFigureOrientation(e,{newCoords:t,size:r}){for(let o=0;o<r;o++)e.currentFigureCoords.unshift(Array(r).fill(0));e.currentFigureCoords=t},changeCurrentFigureCoordsInGlassTo(e,t){let r=this.getters.getCurrentFigureCoords;for(let i=0;i<4;i++){let s=r[i][1],n=r[i][0];o.Z.set(e.glass[n],s,t)}},matrixForWidget(e,t){let r=this.getters.getNextFigureCoords;if(t>0||"string"===typeof t)for(let i=0;i<4;i++){let s=r[i][1]-3,n=r[i][0]+1;o.Z.set(e.nextFigureWIdgetMatrix[n],s,t)}else e.nextFigureWIdgetMatrix=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]},cleanGlass(e){e.glass=[];for(var t=0;t<21;t++)e.glass.push(Array(10).fill(0))},lineDestroyer(e,t){e.glass.splice(t,1),e.glass.unshift(Array(10).fill(0)),e.scoreCounter++}}});o.Z.config.productionTip=!1;const j=new o.Z({router:Z,store:J,render:e=>e(I)}).$mount("#app");window.$app=j}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,r),s.exports}r.m=e,function(){var e=[];r.O=function(t,o,i,s){if(!o){var n=1/0;for(g=0;g<e.length;g++){o=e[g][0],i=e[g][1],s=e[g][2];for(var a=!0,u=0;u<o.length;u++)(!1&s||n>=s)&&Object.keys(r.O).every((function(e){return r.O[e](o[u])}))?o.splice(u--,1):(a=!1,s<n&&(n=s));if(a){e.splice(g--,1);var l=i();void 0!==l&&(t=l)}}return t}s=s||0;for(var g=e.length;g>0&&e[g-1][2]>s;g--)e[g]=e[g-1];e[g]=[o,i,s]}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,o){return r.f[o](e,t),t}),[]))}}(),function(){r.u=function(e){return"js/"+e+".58d60a73.js"}}(),function(){r.miniCssF=function(e){}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="tetris:";r.l=function(o,i,s,n){if(e[o])e[o].push(i);else{var a,u;if(void 0!==s)for(var l=document.getElementsByTagName("script"),g=0;g<l.length;g++){var c=l[g];if(c.getAttribute("src")==o||c.getAttribute("data-webpack")==t+s){a=c;break}}a||(u=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",t+s),a.src=o),e[o]=[i];var d=function(t,r){a.onerror=a.onload=null,clearTimeout(h);var i=e[o];if(delete e[o],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((function(e){return e(r)})),t)return t(r)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),u&&document.head.appendChild(a)}}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){r.p="/tetris-vue/"}(),function(){var e={143:0};r.f.j=function(t,o){var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)o.push(i[2]);else{var s=new Promise((function(r,o){i=e[t]=[r,o]}));o.push(i[2]=s);var n=r.p+r.u(t),a=new Error,u=function(o){if(r.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var s=o&&("load"===o.type?"missing":o.type),n=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+n+")",a.name="ChunkLoadError",a.type=s,a.request=n,i[1](a)}};r.l(n,u,"chunk-"+t,t)}},r.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,s,n=o[0],a=o[1],u=o[2],l=0;if(n.some((function(t){return 0!==e[t]}))){for(i in a)r.o(a,i)&&(r.m[i]=a[i]);if(u)var g=u(r)}for(t&&t(o);l<n.length;l++)s=n[l],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(g)},o=self["webpackChunktetris"]=self["webpackChunktetris"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[998],(function(){return r(28)}));o=r.O(o)})();
//# sourceMappingURL=app.0897c6a3.js.map